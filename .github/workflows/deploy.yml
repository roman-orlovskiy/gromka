name: Deploy

on: [push]
jobs:
    deploy:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v3
            - run: |
                  set -eu
                  mkdir "$HOME/.ssh"
                  echo "${{secrets.regru_key}}" > "$HOME/.ssh/regru_key"
                  chmod 600 "$HOME/.ssh/regru_key"
                  npm ci
                  npm run build
                  cd dist
                  rsync -e "ssh -i $HOME/.ssh/regru_key -o StrictHostKeyChecking=no" --archive --compress --delete . u1801466@server242.hosting.reg.ru:/var/www/u1801466/data/www/gromka.tech/test